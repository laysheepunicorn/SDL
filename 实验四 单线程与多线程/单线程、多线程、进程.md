# 单线程、多线程、进程

## 实验背景

- 进程
  - 当一个程序开始运行时，它就是一个进程，进程包括运行中的程序和程序所使用到的内存和系统资源。而一个进程又是由多个线程所组成的。
- 单线程
  - 单线程是程序中的一个执行流，每个线程都有自己的专有寄存器(栈指针、程序计数器等)，但代码区是共享的，即不同的线程可以执行同样的函数。
- 多线程
  - 多线程是指程序中包含多个执行流，即在一个程序中可以同时运行多个不同的线程来执行不同的任务，也就是说允许单个程序创建多个并行执行的线程来完成各自的任务。

## 实验过程

- 使用microsoft提供<https://docs.microsoft.com/zh-cn/windows/win32/procthread/creating-threads>的多线程代码可以模拟出10个线程以多线程形式执行的结果

  ![ ](image\多线程结果.JPG)
- 更改代码，按单线程的形式执行，可得执行结果  
  ![ ](image\单线程结果.JPG)

## 实验总结

- 单线程与多线程的区别
  - 在程序中设定每个线程的运行时间相等，单线程的总时间是多线程的线程数倍，说明单线程是``串行``着运行，多线程是``并行``的一起运行，所以多线程的效率大于单线程
  - 但由于设备的限制，多线程不能无限制的增加进程

## 补充：进程实验

- 父进程创建子进程
  - 父进程由<https://docs.microsoft.com/zh-cn/windows/win32/procthread/creating-processes>提供的代码实现
  - 在命令提示符中用代码编译链接得到的CreateProcess.exe打开notepad，notepad就是CreateProcess.exe的子进程
    ![ ](image\子进程.JPG)
- 进程创建子进程与创建线程的区别
  - 相同点
    - 二者都具有ID，一组寄存器，状态，优先级以及所要遵循的调度策略。
    - 每个进程都有一个进程控制块，线程也拥有一个线程控制块。
    - 线程和子进程共享父进程中的资源；线程和子进程独立于它们的父进程，竞争使用处理器资源；线程和子进程的创建者可以在线程和子进程上实行某些控制，比如，创建者可以取消、挂起、继续和修改线程和子进程的优先级；线程和子进程可以改变其属性并创建新的资源。
  - 不同点
    - 线程是进程的一部分, 一个没有线程的进程是可以被看作单线程的，如果一个进程内拥有多个进程，进程的执行过程不是一条线（线程）的，而是多条线（线程）共同完成的。
    - 启动一个线程所花费的空间远远小于启动一个进程所花费的空间，而且，线程间彼此切换所需的时间也远远小于进程间切换所需要的时间。  
    - 与进程的控制表PCB相似，线程也有自己的控制表TCB，但是TCB中所保存的线程状态比PCB表中少多了。
    - 进程是系统所有资源分配时候的一个基本单位，拥有一个完整的虚拟空间地址，并不依赖线程而独立存在。